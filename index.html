<!DOCTYPE html>
<html>
<head>
    <title>Matemágica</title>

    <style>
        .fracao {
            display: inline-flex;
            flex-direction: column;
            align-items: center;
            font-size: 20px;
        }

        .topo {
            line-height: 1.2;
        }

        .linha {
            width: 100%;
            border-top: 2px solid black;
            margin: 2px 0;
        }

        .base {
            line-height: 1.2;
        }
    </style>
</head>
<body>

    <select id="opcoes" onchange="selecionaTipoDeQuestao()">
        <option value="somaSimples">Soma Simples</option>
        <option value="subtracaoSimples">Subtração Simples</option>
        <option value="multiplicacaoSimples">Multiplicação Simples</option>
        <option value="divisaoSimples">Divisão Simples</option>
        <option value="somaMultiplosDigitos">Soma com Múltiplos Dígitos</option>
        <option value="subtracaoMultiplosDigitos">Subtração com Múltiplos Dígitos</option>
        <option value="multiplicacaoMultiplosDigitos">Multiplicação com Múltiplos Dígitos</option>
        <option value="divisaoComMultiplosDigitos">Divisão com Múltiplos Dígitos</option>
        <option value="divisaoRacional">Divisão com resultado fracionado</option>
        <option value="expressoes">Expressões</option>
        <option value="simplificarFracao">Simplificar frações</option>
        <option value="equacoesSimples">Equações Simples</option>
        <option value="sistemasDeEquacoes">Sistemas de Equações</option>
    </select>

    <p id="texto-questao">2 + 2 = x</p>

    <button onclick="checaQuestao('a')"><p id="a">1</p></button><br>
    <button onclick="checaQuestao('b')"><p id="b">2</p></button><br>
    <button onclick="checaQuestao('c')"><p id="c">3</p></button><br>
    <button onclick="checaQuestao('d')"><p id="d">4</p></button><br>

    <button onclick="textoDaQuestao()">Nova questão</button>

    <script>
        let respostaDaQuestao = 4;
        let tipoDeQuestao = "somaSimples";

        function textoDaQuestao() {
            var paragraph = document.getElementById("texto-questao");

            // chama função
            if (tipoDeQuestao === "somaSimples") {
                questao = questaoSomaSimples(1,10);
            } else if (tipoDeQuestao === "subtracaoSimples") {
                questao = questaoSubtracaoSimples(6,10,1,5);
            } else if (tipoDeQuestao === "multiplicacaoSimples") {
                questao = multiplicacaoSimples(1,10);
            } else if (tipoDeQuestao === "divisaoSimples") {
                questao = divisaoSimples(1,20);
            } else if (tipoDeQuestao === "somaMultiplosDigitos") {
                questao = questaoSomaSimples(100,999);
            } else if (tipoDeQuestao === "subtracaoMultiplosDigitos") {
                questao = questaoSubtracaoSimples(500,999,100,499);
            } else if (tipoDeQuestao === "multiplicacaoMultiplosDigitos") {
                questao = multiplicacaoSimples(1,99);
            } else if (tipoDeQuestao === "divisaoComMultiplosDigitos") {
                questao = divisaoSimples(10,99);
            } else if (tipoDeQuestao === "divisaoRacional") {
                questao = divisaoRacional(10, 99);
            } else if (tipoDeQuestao === "expressoes") {
                questao = expressoes();
            } else if (tipoDeQuestao === "simplificarFracao") {
                questao = simplificarFracao();
            } else if (tipoDeQuestao === "equacoesSimples") {
                questao = equacoesSimples();
            } else if (tipoDeQuestao === "sistemasDeEquacoes") {
                questao = sistemasDeEquacoes();
            } else if (tipoDeQuestao === "outro") {
                console.log(tipoDeQuestao)
            }
            
            paragraph.innerHTML = questao;
        }

        function textoDasRespostas(vetorResposta) {
            var paragrafoA = document.getElementById("a");
            var paragrafoB = document.getElementById("b");
            var paragrafoC = document.getElementById("c");
            var paragrafoD = document.getElementById("d");

            paragrafoA.textContent = vetorResposta[0];
            paragrafoB.textContent = vetorResposta[1];
            paragrafoC.textContent = vetorResposta[2];
            paragrafoD.textContent = vetorResposta[3];
        }

        function questaoSomaSimples(min, max) {
            let primeiroNumero = getRandomInt(min, max);
            let segundoNumero = getRandomInt(min, max);
            let questao = `${primeiroNumero} + ${segundoNumero} = x`;
            respostaDaQuestao = primeiroNumero + segundoNumero;
            let vetorResposta = fazVetorResposta(respostaDaQuestao);
            
            // escreve respostas possíveis
            textoDasRespostas(vetorResposta);

            return questao;
        }

        function questaoSubtracaoSimples(min1, max1, min2, max2) {
            let primeiroNumero = getRandomInt(min1, max1);
            let segundoNumero = getRandomInt(min2, max2);
            let questao = `${primeiroNumero} - ${segundoNumero} = x`;
            respostaDaQuestao = primeiroNumero - segundoNumero;
            let vetorResposta = fazVetorResposta(respostaDaQuestao);
            
            // escreve respostas possíveis
            textoDasRespostas(vetorResposta);

            return questao;
        }

        function multiplicacaoSimples(min, max) {
            let primeiroNumero = getRandomInt(min, max);
            let segundoNumero = getRandomInt(min, max);
            let questao = `${primeiroNumero} x ${segundoNumero} = x`;
            respostaDaQuestao = primeiroNumero * segundoNumero;
            let vetorResposta = fazVetorResposta(respostaDaQuestao);
            
            // escreve respostas possíveis
            textoDasRespostas(vetorResposta);

            return questao;
        }

        function divisaoSimples(min, max) {
            respostaDaQuestao = getRandomInt(min, max);
            let segundoNumero = getRandomInt(min, max);
            let primeiroNumero = respostaDaQuestao * segundoNumero;
            let questao = `${primeiroNumero} ÷ ${segundoNumero} = x`;
            let vetorResposta = fazVetorResposta(respostaDaQuestao);
            
            // escreve respostas possíveis
            textoDasRespostas(vetorResposta);

            console.log("Resposta da questão: " + respostaDaQuestao);

            return questao;
        }

        function divisaoRacional(min, max) {
            while (true) {
                primeiroNumero = getRandomInt(min, max);
                segundoNumero = getRandomInt(min, max);
                if (primeiroNumero % segundoNumero > 0) {
                    break;
                }
            }
            respostaDaQuestao = primeiroNumero / segundoNumero;
            respostaDaQuestao = respostaDaQuestao.toFixed(2);
            let questao = `${primeiroNumero} ÷ ${segundoNumero} = x`;
            let vetorResposta = fazVetorResposta(respostaDaQuestao);
            
            // escreve respostas possíveis
            textoDasRespostas(vetorResposta);

            console.log("Resposta da questão: " + respostaDaQuestao);

            return questao;
        }

        function expressoes() {
            const tipos = [
                {
                    texto: "a + b - c + d",
                    calc: (a,b,c,d) => a + b - c + d
                },
                {
                    texto: "(a x b) - (c x d)",
                    calc: (a,b,c,d) => (a * b) - (c * d)
                },
                {
                    texto: "{[(2 x a) + (3 x b)] ÷ c} x d",
                    calc: (a,b,c,d) => ((2*a + 3*b) / c) * d
                },
                {
                    texto: "{(2 x a) + [(3 x b) ÷ c]} x d",
                    calc: (a,b,c,d) => (2*a + (3*b / c)) * d
                },
                {
                    texto: "(5 x a) ÷ (2 + b + c + d)",
                    calc: (a,b,c,d) => (5*a) / (2 + b + c + d)
                },
                {
                    texto: "[(a + b) ÷ c] x d",
                    calc: (a,b,c,d) => ((a + b) / c) * d
                },
                {
                    texto: "a x (b + c + d)",
                    calc: (a,b,c,d) => a * (b + c + d)
                },
                {
                    texto: "a x [(b + c) ÷ d]",
                    calc: (a,b,c,d) => a * ((b + c) / d)
                },
                {
                    texto: "a + b - c - d",
                    calc: (a,b,c,d) => a + b - c - d
                },
                {
                    texto: "a + b x c - d",
                    calc: (a,b,c,d) => a + b * c - d
                },
                {
                    texto: "a - (b x c ÷ d)",
                    calc: (a,b,c,d) => a - (b * c / d)
                },
                {
                    texto: "a x b x c ÷ d",
                    calc: (a,b,c,d) => a * b * c / d
                }
            ];

            const tipo = getRandomInt(0, tipos.length - 1);

            let a = getRandomInt(1,20);
            let b = getRandomInt(1,20);
            let c = getRandomInt(1,20);
            let d = getRandomInt(1,20);

            respostaDaQuestao = tipos[tipo].calc(a,b,c,d);
            respostaDaQuestao = Number(respostaDaQuestao.toFixed(2));
            let vetorResposta = fazVetorResposta(respostaDaQuestao);

            // escreve respostas possíveis
            textoDasRespostas(vetorResposta);

            let questao = tipos[tipo].texto.replaceAll("a", a).replaceAll("b", b).replaceAll("c", c).replaceAll("d", d);

            console.log("Resposta da questão:", respostaDaQuestao);

            return questao;
        }

        function equacoesSimples() {
            const tipos = [
                {
                    texto: "ax + b = c + d",
                    calc: (a,b,c,d) => (c + d - b) / a
                },
                {
                    texto: "ax + bx - c = d",
                    calc: (a,b,c,d) => (d + c) / (a + b)
                },
                {
                    texto: "ax + bx - cx = d",
                    calc: (a,b,c,d) => d / (a + b - c)
                },
                {
                    texto: "ax + b - c = dx",
                    calc: (a,b,c,d) => (c - b) / (a - d)
                },
                {
                    texto: "ax + b - c = d",
                    calc: (a,b,c,d) => (d + c - b) / a
                },
                {
                    texto: "a + b - c = dx",
                    calc: (a,b,c,d) => (c - b - a) / d
                },
                {
                    texto: "a + (b + 32)x - c = dx + 2",
                    calc: (a,b,c,d) => (a - c - 2) / (d - b - 32)
                },
                {
                    texto: "(a + b)x - c = d + 2",
                    calc: (a,b,c,d) => (d + 2 + c) / (a + b)
                },
                {
                    texto: "a + bx - c = 2*d + 2",
                    calc: (a,b,c,d) => (2*d + 2 + c - a) / b
                },
                {
                    texto: "a + bx - cx = d + 10",
                    calc: (a,b,c,d) => (d + 10 + c - a) / (b - c)
                }
            ];

            const tipo = getRandomInt(0, tipos.length - 1);

            let a = getRandomInt(1,20);
            let b = getRandomInt(1,20);
            let c = getRandomInt(1,20);
            let d = getRandomInt(1,20);

            respostaDaQuestao = tipos[tipo].calc(a,b,c,d);
            respostaDaQuestao = Number(respostaDaQuestao.toFixed(2));
            let vetorResposta = fazVetorResposta(respostaDaQuestao);

            // escreve respostas possíveis
            textoDasRespostas(vetorResposta);

            let questao = tipos[tipo].texto.replaceAll("a", a).replaceAll("b", b).replaceAll("c", c).replaceAll("d", d);

            console.log("Resposta da questão:", respostaDaQuestao);

            return questao;
        }

        function sistemasDeEquacoes() {
            questao = "Encontre o valor de x em:<br>a1x + b1y = c1<br>a2x + b2y = c2";           
            let a1 = getRandomInt(1,10);
            let b1 = getRandomInt(1,10);
            let c1 = getRandomInt(1,10);
            let a2 = getRandomInt(1,10);
            let b2 = getRandomInt(1,10);
            let c2 = getRandomInt(1,10);

            let y = (b2 * c1 - b1 * c2) / (a1 * b2 - a2 * b1);
            y = y.toFixed(2);
            let x = (c1 - b1 * y) / a1;
            x = x.toFixed(2);

            respostaDaQuestao = x;

            questao = questao.replaceAll("a1", a1).replaceAll("b1", b1).replaceAll("c1", c1).replaceAll("a2", a2).replaceAll("b2", b2).replaceAll("c2", c2);

            let vetorResposta = fazVetorResposta(respostaDaQuestao);
            textoDasRespostas(vetorResposta);

             console.log("Resposta da questão:", x, y);

            return questao;
        }

        function simplificarFracao() {
            let numerador = getRandomInt(1,100);
            let denominador = getRandomInt(1,100);
            respostaDaQuestao = `${numerador} / ${denominador}`;

            let fator1 = getRandomInt(1,4);
            let fator2 = getRandomInt(2,5);
            denominador = denominador * fator1 * fator2;
            numerador = numerador * fator1 * fator2;
            let questao = `Simplifique a fração: <br> 
            <span class="fracao">
                <span class="topo">${numerador}</span>
                <span class="linha"></span>
                <span class="base">${denominador}</span>
            </span>`;
            
            let vetorResposta = fazVetorRespostaFracao(numerador, denominador, fator1 * fator2);
            textoDasRespostas(vetorResposta);

            console.log("Resposta da questão:", respostaDaQuestao);

            return questao;
        }

        function fazVetorResposta(resposta) {
            let tipo = getRandomInt(1, 4);

            if (!Number.isInteger(resposta)) {
                if (tipo === 1) {
                    return [resposta,( resposta*0.9).toFixed(2), (resposta*1.1).toFixed(2), (resposta*1.2).toFixed(2)];
                } else if (tipo === 2) {
                    return [(resposta*1.2).toFixed(2), resposta, (resposta*0.9).toFixed(2), (resposta*0.8).toFixed(2)];
                } else if (tipo === 3){
                    return [(resposta*1.4).toFixed(2), (resposta*0.9).toFixed(2), resposta, (resposta*1.1).toFixed(2)];
                } else if (tipo === 4) {
                    return [(resposta*1.1).toFixed(2), (resposta*0.9).toFixed(2), (resposta*0.8).toFixed(2), resposta];
                }
            } else if (resposta < 200) {
                if (tipo === 1) {
                    return [resposta, resposta + 1, resposta -1, resposta + 2];
                } else if (tipo === 2) {
                    return [resposta + 1, resposta, resposta + 2, resposta -1];
                } else if (tipo === 3){
                    return [resposta -1, resposta + 2, resposta, resposta - 2];
                } else if (tipo === 4) {
                    return [resposta + 2, resposta -1, resposta - 2, resposta];
                }
            } else {
                if (tipo === 1) {
                    return [resposta, resposta + 120, resposta - 10, resposta + 10];
                } else if (tipo === 2) {
                    return [resposta + 40, resposta, resposta - 20, resposta - 120];
                } else if (tipo === 3){
                    return [resposta - 110, resposta + 20, resposta, resposta + 40];
                } else if (tipo === 4) {
                    return [resposta + 120, resposta -10, resposta - 20, resposta];
                }
            }
        }

        function fazVetorRespostaFracao(numerador, denominador, fator) {
            let tipo = getRandomInt(1, 4);
            console.log("Fator de simplificação:", numerador, denominador, fator);
            numerador = numerador / fator;
            denominador = denominador / fator;

            if (tipo === 1) {
                return [`${numerador} / ${denominador}`, `${numerador + 1} / ${denominador + 1}`, `${numerador - 1} / ${denominador - 1}`, `${numerador + 2} / ${denominador + 2}`];
            } else if (tipo === 2) {
                return [ `${numerador + 1} / ${denominador + 1}`, `${numerador} / ${denominador}`, `${numerador - 1} / ${denominador - 1}`, `${numerador + 2} / ${denominador + 2}`];
            } else if (tipo === 3){
                return [`${numerador - 1} / ${denominador - 1}`, `${numerador + 2} / ${denominador + 2}`, `${numerador} / ${denominador}`, `${numerador - 2} / ${denominador - 2}`];
            } else if (tipo === 4) {
                return [`${numerador + 2} / ${denominador + 2}`, `${numerador + 1} / ${denominador - 1}`, `${numerador - 2} / ${denominador - 1}`, `${numerador} / ${denominador}`];
            }
        }

        function getRandomInt(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }

        function checaQuestao(letra) {
            var paragrafo = document.getElementById(letra);

            if (paragrafo) {
                console.log(paragrafo.textContent + " - " + respostaDaQuestao);
                console.log(paragrafo.textContent === respostaDaQuestao);
                if (paragrafo.textContent === respostaDaQuestao) {
                    alert("Resposta correta!");
                } else if (Number(paragrafo.textContent) === Number(respostaDaQuestao)) {
                    alert("Resposta correta!");
                } else {
                    alert("Resposta incorreta. Tente novamente!");
                }
            } else {
                console.log("No paragraph found with id: " + letra);
            }
        }

        //////
        function selecionaTipoDeQuestao() {
            var select = document.getElementById("opcoes");
            tipoDeQuestao = select.value;

            console.log("Tipo de questão selecionada: " + tipoDeQuestao);
        }
    </script>

</body>
</html>